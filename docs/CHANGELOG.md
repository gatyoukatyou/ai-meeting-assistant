# 変更履歴

## v0.9.1 (2024-12-28) - セキュリティ強化・テーマ機能追加

### セキュリティ修正 (P0)

- **XSS脆弱性の修正**: toast通知とエラー表示でinnerHTMLをtextContentに置換
- **入力サイズ制限**: 50,000文字を超える入力をブロック（コスト暴発防止）
- **BYOK警告追加**: READMEに公式URL以外でのキー入力禁止を明記

### 新機能

- **カラーテーマ切替**: 6種類のアクセントカラー（Sky, Indigo, Emerald, Violet, Slate, Coral）
- 設定画面から選択可能、localStorageに保存

### 技術的変更

- `js/theme.js`: テーマ管理モジュールを追加
- CSS変数 `--primary`, `--primary-hover` をテーマに連動
- i18nキー追加（テーマ名の多言語対応）

---

## v0.9.0 (2024-12-23) - PWA化・スマホ最適化版

### 🎯 主要改善

- **PWA対応**: ホーム画面に追加してアプリのように使える
- **スマホUI最適化**: タッチしやすいボタンサイズ、読みやすいフォントサイズ
- **録音ボタン強化**: スマホで大きく目立つデザイン

### 新機能

- **manifest.json**: PWA設定ファイルを追加
- **ホーム画面追加対応**: iOS/Androidでアプリアイコンとして追加可能
- **レスポンシブデザイン強化**: スマホ専用のレイアウト最適化

### 改善

- 全てのボタンを最小44×44pxに（タッチターゲット）
- スマホで録音ボタンを大きく（50px高、影付き、録音中はパルスアニメーション）
- トースト通知をスマホでは画面下部に表示
- カスタム質問入力を16pxに（iOSの自動ズーム防止）
- README.mdにスマホでの使い方を追加
- ブラウザ対応表にスマホブラウザを追加

### 技術的変更

- `viewport-fit=cover`を追加（iPhone X以降のノッチ対応）
- Apple専用のメタタグ追加（`apple-mobile-web-app-*`）
- スマホ専用CSSメディアクエリを大幅拡充
- ICON_CREATION_GUIDE.mdを追加（アイコン作成ガイド）

### 注意事項

- **アイコン画像が未作成**: `icon-192.png`と`icon-512.png`を作成する必要があります
- ICON_CREATION_GUIDE.mdを参照してアイコンを作成してください

## v0.8.0 (2024-12-23) - 安定性・リアルタイム性向上版

### 🎯 主要改善

- **文字起こしの安定性向上**: MediaRecorderの連続録音化により、途中で途切れる問題を解決
- **リアルタイム性向上**: 5秒・10秒インターバルを追加（従来は15秒が最短）
- **エラーハンドリング強化**: API呼び出し失敗時の自動リトライ（最大3回、指数バックオフ）

### 新機能

- **トースト通知UI**: 録音開始・停止・エラー時の視覚的フィードバック
- **リトライ機能**: ネットワーク一時エラー時の自動再試行
- **小さすぎる音声データのスキップ**: 無音時のAPI呼び出しを削減しコスト削減

### 改善

- MediaRecorderを停止せずに継続録音（途切れ問題の根本解決）
- API呼び出しに `fetchWithRetry()` を導入
- エラー発生時も録音を継続
- README.mdの使い方セクションを全面改訂（GitHub Pages推奨を明記）
- よくある質問に「オンライン版とローカル版の違い」を追加

### 技術的変更

- `processAudioChunk()`: MediaRecorder停止・再起動ロジックを削除
- 全てのAPI呼び出しに自動リトライを実装
- トースト通知システムの追加（CSS + JavaScript）

## v0.7.0 (2024-12-22) - ドキュメント改善版

### 改善

- README.mdの全面的な書き直し
- より分かりやすい説明文に変更

## v0.6.0 (2024-12-18) - 法的ドキュメント追加・機能強化版

### 新機能

- **文字起こしAPI選択**: Gemini Audio / OpenAI Whisper から選択可能に
- **LLM自動選択**: 設定されたAPIキーから自動的に使用可能なLLMを選択
- **LLM優先順位設定**: 好みのLLMを優先的に使用するオプション

### 改善

- コスト表示を文字起こしとLLMで完全分離
- 設定画面のUI改善（文字起こし用API / LLM専用API のグループ分け）
- フッターに法的リンクを追加

### 法的ドキュメント追加

- **プライバシーポリシー** (PRIVACY.md): 個人情報の取り扱いについて
- **利用規約** (TERMS.md): サービス利用条件
- ウェルカム画面に規約同意文言を追加

## v0.5.0 (2024-12-18) - セキュリティ強化版

### セキュリティ機能追加

- **APIキーの暗号化保存**: XOR暗号化 + Base64エンコードでlocalStorageに保存
- **デバイス固有キー**: crypto.getRandomValuesで生成される256bitキーで暗号化
- **自動削除オプション**: ブラウザを閉じた際にAPIキーを自動削除（共有PC向け）
- **APIキー検証機能**: 保存前にAPIキーの有効性を確認
- **設定のエクスポート/インポート**: パスワード付き暗号化ファイルで設定を持ち出し可能

### その他の変更

- セキュリティ説明の強化（設定画面内に詳細表示）
- 全設定削除機能の追加
- SECURITY.mdドキュメント追加

## v0.4.0 - 安定版

### 機能追加

- MediaRecorder + Gemini Audio APIによる安定した文字起こし
- 複数LLM対応（Gemini, Claude, OpenAI, Groq）
- API利用料金の概算表示
- タブ別AI回答管理（要約は上書き、意見・アイデアは蓄積）
- Q&A形式の自由質問履歴
- Markdownエクスポート機能
- ウェルカムモーダル

### 改善

- Web Speech APIから MediaRecorder + Gemini Audio への移行（安定性向上）
- コスト計算の精度向上
- UI/UXの改善

## v0.3.0 - β版

- Gemini Audio APIによる文字起こし実装
- 基本的なAI質問機能
- コスト表示機能（プロトタイプ）

## v0.2.0 - α版

- Web Speech APIによる文字起こし（不安定）
- OpenAI APIによるAI質問機能

## v0.1.0 - 初期版

- 基本的なUI設計
- 録音機能のプロトタイプ
